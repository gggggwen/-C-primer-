# Chapter13 引用



##  13.1 引用的介绍

- 引用变量是C++新增的复合类型。

- 引用是已定义的变量的别名。

- 引用的主要用途是用作函数的形参和返回值。

- 声明/创建引用的语法：**数据类型 &引用名=原变量名;**

**注意事项**:

- 引用的数据类型要与原变量名的数据类型相同。
-  引用名和原变量名可以互换，**它们值和内存单元是相同的**。
-  **必须**在声明引用的时候初始化，**初始化后不可改变**。
-  C和C++用&符号来指示/取变量的地址，C++给&符号赋予了另一种含义。

<img src="./photo/image-20240713205145310.png" alt="image-20240713205145310" style="zoom:50%;" />



## 13.2 引用的本质

引用是指针常量的伪装。引用是编译器提供的一个有用且安全的工具，去除了指针的一些缺点，禁止了部分不安全的操作。

变量是什么？变量就是一个在程序执行过程中可以改变的量。换一个角度，变量是一块内存区域的名字，它代表了这块内存区域，当我们对变量进行修改的时候，会引起内存区域中内容的改变。

在计算机看来，内存区域根本就不存在什么名字，它仅有的标志就是它的地址，因此我们若想修改一块内存区域的内容，只有知道他的地址才能实现。

所谓的变量只不过是编译器给我们进行的一种抽象，让我们不必去了解更多的细节，降低我们的思维跨度而已。

程序员拥有引用，但编译器仅拥有指针（地址）。

引用的底层机制实际上是和指针一样的。不要相信有别名，不要认为引用可以节省一个指针的空间，因为这一切不会发生，编译器还是会把引用解释为指针。

 **引用和指针本质上没有区别。**



### 13.3 引用作函数参数传递

- 将引用作为函数的形参, 在函数内部就是**实参的别名**

- 这种方法也叫按引用传递或传引用。（传值、传地址、传引用只是说法不同，其实都是传值。）引用的本质是指针，传递的是变量的地址，在函数中，修改形参会影响实参。

  

示例: 设计一个函数为一个指针动态开辟内存空间

```c++
void func1(int ** p)
{
    *p = new int(3);
}
void func2(int* &p)
{
     p = new int(3);
}

int main()
{
    int *p =nullptr;
    func1(&p);
    //func2(p);
}
```

解释:

- 为什么func1 要传入二级指针? 首先是因为需要对一级指针p进行修改(分配内存空间),因此需要将**指针的地址传入** ,变量类型也就是二级指针

- 解引用的出现让参数不必为二级指针 ,且使得定义的函数可读性更佳 , 更易写